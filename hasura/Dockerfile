FROM hasura/graphql-engine:v2.8.4.cli-migrations-v3

ENV HASURA_GRAPHQL_MIGRATIONS_DIR /hasura-migrations
ENV HASURA_GRAPHQL_METADATA_DIR /hasura-metadata
ENV HASURA_GRAPHQL_SEEDS_DIR  /hasura-seeds
ENV HASURA_PORT 8080

COPY migrations $HASURA_GRAPHQL_MIGRATIONS_DIR
COPY metadata $HASURA_GRAPHQL_METADATA_DIR
COPY seeds $HASURA_GRAPHQL_SEEDS_DIR

EXPOSE $HASURA_PORT

CMD graphql-engine \
  serve \
  --database-url $HASURA_GRAPHQL_DATABASE_URL 